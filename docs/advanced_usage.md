<!--[metadata]>
+++
title = "Advanced Notary Usage"
description = "Becoming a power user of the notary client."
keywords = ["docker, notary, notary-client, docker content trust, content trust, power user, advanced"]
[menu.main]
parent="mn_notary"
weight=2
+++
<![end-metadata]-->

# Contents

- [Who should read this?](#who_should_read_this)
- [Important Note](#important_note)
- [Initializing a Repository](#initializing_a_repository)
- [Adding and Removing Targets](#adding_and_removing_targets)
- [Working with Delegations](#working_with_delegations)
- [Managing Keys](#managing_keys)
  - [Rotating Keys](#rotating_keys)
  - [Remote vs Local Keys](#remote_vs_local_keys)
  - [Using a Yubikey](#using_a_yubikey)
- [Files on Disk](#files_on_disk)

# <a name="who_should_read_this">Who should read this?</a>

This document is for power users of the notary client or those interested in the more complex features. It describes use cases in a context independent of Docker Content Trust. You must be [running your own server](running_a_server.md).

# <a name="important_note">Important Note</a>

Commands in this document will omit the `-s` and `-d` flags. If you do not know what these do, please read the [Getting Started](getting_started.md) docs before continuing. Once you understand what these flags do, you are expected to provide your own values for them while following this document.

# <a name="initializing_a_repository">Initializing a Repository</a>

Before adding and signing content to a repository, we must first initialize that repository. 

```
$ notary init example.com/collection

No root keys found. Generating a new root key...
You are about to create a new root signing key passphrase. This passphrase
will be used to protect the most sensitive key in your signing system. Please
choose a long, complex passphrase and be careful to keep the password and the
key file itself secure and backed up. It is highly recommended that you use a
password manager to generate the passphrase and keep it safe. There will be no
way to recover this key. You can find the key in your config directory.
Enter passphrase for new root key with ID 1f54328:
Repeat passphrase for new root key with ID 1f54328:
Enter passphrase for new targets key with ID 1df39fc (example.com/collection):
Repeat passphrase for new targets key with ID 1df39fc (example.com/collection):
```

Initializing a repository will generate the following items; all keys use aysmmetric algorithms, but there is no requirement that they all use the _same_ algorithm:

- If no root key is found, an initial root key will be generated. This key will be used as the default root of trust for all your repositories.
- A targets key and a snapshot key. The same password is used to encrypt both of these as the security profile of them (when both held by the author of the repository) is identical. This is why you will not be asked for a snapshot key password.
- A timestamp key. This is generated by the server on a request from the client, returning just the public key. The server holds the private key and will sign timestamps on behalf of the user. 
- Stub signed notary metadata. This stages the base version of the trust metadata for the repository. It will be finalized when it is published to the server.

# <a name="adding_and_removing_targets">Adding and Removing Targets</a>



# <a name="working_with_delegations">Working with Delegations</a>

# <a name="managing_keys">Managing Keys</a>

## <a name="rotating_keys">Rotating Keys</a>

## <a name="remote_vs_local_keys">Remote vs Local Keys</a>

## <a name="using_a_yubikey">Using a Yubikey</a>

# <a name="files_on_disk">Files on Disk</a>
